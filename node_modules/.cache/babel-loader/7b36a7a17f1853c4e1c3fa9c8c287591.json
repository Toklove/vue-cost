{"remainingRequest":"/www/wwwroot/vue/node_modules/babel-loader/lib/index.js!/www/wwwroot/vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/www/wwwroot/vue/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/www/wwwroot/vue/src/views/Data.vue?vue&type=script&lang=js","dependencies":[{"path":"/www/wwwroot/vue/src/views/Data.vue","mtime":1627217647227},{"path":"/www/wwwroot/vue/node_modules/cache-loader/dist/cjs.js","mtime":1627220017878},{"path":"/www/wwwroot/vue/node_modules/babel-loader/lib/index.js","mtime":1627220017809},{"path":"/www/wwwroot/vue/node_modules/cache-loader/dist/cjs.js","mtime":1627220017878},{"path":"/www/wwwroot/vue/node_modules/vue-loader-v16/dist/index.js","mtime":1627220029206}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi93d3cvd3d3cm9vdC92dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvd3d3L3d3d3Jvb3QvdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IHsgcmVmLCBvbk1vdW50ZWQsIHJlYWN0aXZlLCB0b1JlZnMsIG9uVW5tb3VudGVkIH0gZnJvbSAndnVlJzsgLy8g5LiN6KaB5L2/55SoIGltcG9ydCBlY2hhcnRzIGZyb20gJ2VjaGFydHMnIOWboOS4uiA1LjAg54mI5pys55qEIGVjaGFydHMg55qE5o6l5Y+j5bey57uP5Y+Y5oiQ5LqG5LiL6Z2i6L+Z5qC3Ci8vIGV4cG9ydCB7IEVDaGFydHNGdWxsT3B0aW9uIGFzIEVDaGFydHNPcHRpb24sIGNvbm5lY3QsIGRpc0Nvbm5lY3QsIGRpc3Bvc2UsIGdldEluc3RhbmNlQnlEb20sIGdldEluc3RhbmNlQnlJZCwgZ2V0TWFwLCBpbml0LCByZWdpc3RlckxvY2FsZSwgcmVnaXN0ZXJNYXAsIHJlZ2lzdGVyVGhlbWUgfTsKLy8gaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2VjaGFydHMnCgppbXBvcnQgZGF5anMgZnJvbSAnZGF5anMnOwppbXBvcnQgUG9wTW9udGggZnJvbSAnLi4vY29tcG9uZW50cy9Qb3BNb250aC52dWUnOwppbXBvcnQgYXhpb3MgZnJvbSAnLi4vdXRpbHMvYXhpb3MnOwppbXBvcnQgeyB0eXBlTWFwIH0gZnJvbSAnLi4vdXRpbHMnOwp2YXIgcHJvcG9ydGlvbkNoYXJ0ID0gbnVsbDsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEYXRhJywKICBjb21wb25lbnRzOiB7CiAgICBQb3BNb250aDogUG9wTW9udGgKICB9LAogIHNldHVwOiBmdW5jdGlvbiBzZXR1cCgpIHsKICAgIHZhciBwb3BNb250aFJlZiA9IHJlZihudWxsKTsKICAgIHZhciBzdGF0ZSA9IHJlYWN0aXZlKHsKICAgICAgdHlwZU1hcDogdHlwZU1hcCwKICAgICAgY3VycmVudE1vbnRoOiBkYXlqcygpLmZvcm1hdCgnWVlZWS1NTScpLAogICAgICB0b3RhbF9leHBlbnNlOiAwLAogICAgICB0b3RhbF9pbmNvbWU6IDAsCiAgICAgIGV4cGVuc2VfZGF0YTogW10sCiAgICAgIGluY29tZV9kYXRhOiBbXSwKICAgICAgdG90YWxUeXBlOiAnZXhwZW5zZScsCiAgICAgIHBpZVR5cGU6ICdleHBlbnNlJwogICAgfSk7CiAgICBvbk1vdW50ZWQoZnVuY3Rpb24gKCkgewogICAgICBnZXREYXRhKCk7CiAgICB9KTsKICAgIG9uVW5tb3VudGVkKGZ1bmN0aW9uICgpIHsKICAgICAgLy8g5q+P5qyh57uE5Lu25Y246L2955qE5pe25YCZ77yM6ZyA6KaB6YeK5pS+5Zu+6KGo5a6e5L6L44CCY2xlYXIg5Y+q5piv5bCG5YW25riF56m65LiN5Lya6YeK5pS+44CCCiAgICAgIHByb3BvcnRpb25DaGFydC5kaXNwb3NlKCk7CiAgICB9KTsKCiAgICB2YXIgZ2V0RGF0YSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBfeWllbGQkYXhpb3MkZ2V0LCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvcy5nZXQoIi9iaWxsL2RhdGE/ZGF0ZT0iLmNvbmNhdChzdGF0ZS5jdXJyZW50TW9udGgpKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX3lpZWxkJGF4aW9zJGdldCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJGF4aW9zJGdldC5kYXRhOwogICAgICAgICAgICAgICAgLy8g5oC75pS25pSvCiAgICAgICAgICAgICAgICBzdGF0ZS50b3RhbF9leHBlbnNlID0gZGF0YS50b3RhbF9leHBlbnNlOwogICAgICAgICAgICAgICAgc3RhdGUudG90YWxfaW5jb21lID0gZGF0YS50b3RhbF9pbmNvbWU7IC8vIOi/h+a7pOaUr+WHuuWSjOaUtuWFpQoKICAgICAgICAgICAgICAgIHN0YXRlLmV4cGVuc2VfZGF0YSA9IGRhdGEudG90YWxfZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucGF5X3R5cGUgPT0gMTsKICAgICAgICAgICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGIubnVtYmVyIC0gYS5udW1iZXI7CiAgICAgICAgICAgICAgICB9KTsgLy8g6L+H5ruk5Ye66LSm5Y2V57G75Z6L5Li65pSv5Ye655qE6aG5CgogICAgICAgICAgICAgICAgc3RhdGUuaW5jb21lX2RhdGEgPSBkYXRhLnRvdGFsX2RhdGEuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnBheV90eXBlID09IDI7CiAgICAgICAgICAgICAgICB9KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBiLm51bWJlciAtIGEubnVtYmVyOwogICAgICAgICAgICAgICAgfSk7IC8vIOi/h+a7pOWHuui0puWNleexu+Wei+S4uuaUtuWFpeeahOmhuQoKICAgICAgICAgICAgICAgIHNldFBpZUNoYXJ0KCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpOyAvLyDliIfmjaLmlLbmlK/mnoTmiJDnsbvlnosKCgogICAgdmFyIGNoYW5nZVRvdGFsVHlwZSA9IGZ1bmN0aW9uIGNoYW5nZVRvdGFsVHlwZSh0eXBlKSB7CiAgICAgIHN0YXRlLnRvdGFsVHlwZSA9IHR5cGU7CiAgICB9OyAvLyDliIfmjaLppbzlm77mlLbmlK/nsbvlnosKCgogICAgdmFyIGNoYW5nZVBpZVR5cGUgPSBmdW5jdGlvbiBjaGFuZ2VQaWVUeXBlKHR5cGUpIHsKICAgICAgc3RhdGUucGllVHlwZSA9IHR5cGU7IC8vIOmHjee7mOmlvOWbvgoKICAgICAgc2V0UGllQ2hhcnQoKTsKICAgIH07IC8vIOe7mOWItumlvOWbvuaWueazlQoKCiAgICB2YXIgc2V0UGllQ2hhcnQgPSBmdW5jdGlvbiBzZXRQaWVDaGFydCgpIHsKICAgICAgaWYgKHdpbmRvdy5lY2hhcnRzKSB7CiAgICAgICAgcHJvcG9ydGlvbkNoYXJ0ID0gZWNoYXJ0cy5pbml0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9wb3J0aW9uJykpOwoKICAgICAgICB2YXIgX2RhdGEgPSBzdGF0ZS5waWVUeXBlID09ICdleHBlbnNlJyA/IHN0YXRlLmV4cGVuc2VfZGF0YSA6IHN0YXRlLmluY29tZV9kYXRhOwoKICAgICAgICBwcm9wb3J0aW9uQ2hhcnQuc2V0T3B0aW9uKHsKICAgICAgICAgIHRvb2x0aXA6IHsKICAgICAgICAgICAgdHJpZ2dlcjogJ2l0ZW0nLAogICAgICAgICAgICBmb3JtYXR0ZXI6ICd7YX0gPGJyLz57Yn0gOiB7Y30gKHtkfSUpJwogICAgICAgICAgfSwKICAgICAgICAgIC8vIOWbvuS+iwogICAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICAgIGRhdGE6IF9kYXRhLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiBpdGVtLnR5cGVfbmFtZTsKICAgICAgICAgICAgfSkKICAgICAgICAgIH0sCiAgICAgICAgICBzZXJpZXM6IFt7CiAgICAgICAgICAgIG5hbWU6ICfmlK/lh7onLAogICAgICAgICAgICB0eXBlOiAncGllJywKICAgICAgICAgICAgcmFkaXVzOiAnNTUlJywKICAgICAgICAgICAgZGF0YTogX2RhdGEubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLm51bWJlciwKICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0udHlwZV9uYW1lCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIGVtcGhhc2lzOiB7CiAgICAgICAgICAgICAgaXRlbVN0eWxlOiB7CiAgICAgICAgICAgICAgICBzaGFkb3dCbHVyOiAxMCwKICAgICAgICAgICAgICAgIHNoYWRvd09mZnNldFg6IDAsCiAgICAgICAgICAgICAgICBzaGFkb3dDb2xvcjogJ3JnYmEoMCwgMCwgMCwgMC41KScKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07IC8vIOaciOS7veW8ueeql+W8gOWFswoKCiAgICB2YXIgbW9udGhUb2dnbGUgPSBmdW5jdGlvbiBtb250aFRvZ2dsZSgpIHsKICAgICAgcG9wTW9udGhSZWYudmFsdWUudG9nZ2xlKCk7CiAgICB9OwoKICAgIHZhciBzZWxlY3RNb250aCA9IGZ1bmN0aW9uIHNlbGVjdE1vbnRoKGl0ZW0pIHsKICAgICAgc3RhdGUuY3VycmVudE1vbnRoID0gaXRlbTsKICAgICAgZ2V0RGF0YSgpOwogICAgfTsKCiAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0b1JlZnMoc3RhdGUpKSwge30sIHsKICAgICAgcG9wTW9udGhSZWY6IHBvcE1vbnRoUmVmLAogICAgICBzZWxlY3RNb250aDogc2VsZWN0TW9udGgsCiAgICAgIG1vbnRoVG9nZ2xlOiBtb250aFRvZ2dsZSwKICAgICAgY2hhbmdlVG90YWxUeXBlOiBjaGFuZ2VUb3RhbFR5cGUsCiAgICAgIGNoYW5nZVBpZVR5cGU6IGNoYW5nZVBpZVR5cGUKICAgIH0pOwogIH0KfTs="},{"version":3,"sources":["/www/wwwroot/vue/src/views/Data.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"data\">\n    <div class=\"total\">\n      <div class=\"time\" @click=\"monthToggle\">\n        <span>{{ currentMonth }}</span>\n        <van-icon name=\"notes-o\" />\n      </div>\n      <div class=\"title\">共支出</div>\n      <div class=\"expense\">¥{{ total_expense || 0 }}</div>\n      <div class=\"income\">共收入¥{{ total_income || 0 }}</div>\n    </div>\n    <div class=\"structure\">\n      <div class=\"head\">\n        <span class=\"title\">收支构成</span>\n        <div class=\"tab\">\n          <span @click=\"changeTotalType('expense')\" class=\"expense\" :class=\"{ active: totalType == 'expense' }\">支出</span>\n          <span @click=\"changeTotalType('income')\" class=\"income\" :class=\"{ active: totalType == 'income' }\">收入</span>\n        </div>\n      </div>\n      <div class=\"content\">\n        <div class=\"item\" v-for=\"item in totalType == 'expense' ? expense_data : income_data\" :key=\"item.type_id\">\n          <div class=\"left\">\n            <div class=\"type\">\n              <span :class=\"{ expense: totalType == 'expense', income: totalType == 'income' }\">\n                <i class=\"iconfont\" :class=\"item.type_id ? typeMap[item.type_id].icon : 0\" />\n              </span>\n              <span>{{ item.type_name }}</span>\n            </div>\n            <div class=\"progress\">{{ Number((item.number / Number(totalType == 'expense' ? total_expense : total_income)) * 100).toFixed(2) }}%</div>\n          </div>\n          <div class=\"right\">\n            <div class=\"percent\">\n              <van-progress :percentage=\"Number((item.number / Number(totalType == 'expense' ? total_expense : total_income)) * 100)\" stroke-width=\"6px\" :show-pivot=\"false\" track-color=\"#ffffff\" color=\"#39be77\" />\n            </div>\n            <div class=\"money\">¥{{ Number(item.number).toFixed(2) || 0 }}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"proportion\">\n      <div class=\"head\">\n        <span class=\"title\">收支构成</span>\n        <div class=\"tab\">\n          <span @click=\"changePieType('expense')\" class=\"expense\" :class=\"{ active: pieType == 'expense' }\">支出</span>\n          <span @click=\"changePieType('income')\" class=\"income\" :class=\"{ active: pieType == 'income' }\">收入</span>\n        </div>\n      </div>\n      <div id=\"proportion\"></div>\n    </div>\n    <PopMonth ref=\"popMonthRef\" @select=\"selectMonth\" />\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, reactive, toRefs, onUnmounted } from 'vue'\n// 不要使用 import echarts from 'echarts' 因为 5.0 版本的 echarts 的接口已经变成了下面这样\n// export { EChartsFullOption as EChartsOption, connect, disConnect, dispose, getInstanceByDom, getInstanceById, getMap, init, registerLocale, registerMap, registerTheme };\n// import { init } from 'echarts'\nimport dayjs from 'dayjs'\nimport PopMonth from '../components/PopMonth.vue'\nimport axios from '../utils/axios'\nimport { typeMap } from '../utils'\n\nlet proportionChart = null\nexport default {\n  name: 'Data',\n  components: {\n    PopMonth\n  },\n  setup() {\n    const popMonthRef = ref(null)\n    const state = reactive({\n      typeMap,\n      currentMonth: dayjs().format('YYYY-MM'),\n      total_expense: 0,\n      total_income: 0,\n      expense_data: [],\n      income_data: [],\n      totalType: 'expense',\n      pieType: 'expense',\n    })\n\n    onMounted(() => {\n      getData()\n    })\n\n    onUnmounted(() => {\n      // 每次组件卸载的时候，需要释放图表实例。clear 只是将其清空不会释放。\n      proportionChart.dispose()\n    })\n\n    const getData = async () => {\n      const { data } = await axios.get(`/bill/data?date=${state.currentMonth}`)\n\n      // 总收支\n      state.total_expense = data.total_expense\n      state.total_income = data.total_income\n\n      // 过滤支出和收入\n      state.expense_data = data.total_data.filter(item => item.pay_type == 1).sort((a, b) => b.number - a.number) // 过滤出账单类型为支出的项\n      state.income_data = data.total_data.filter(item => item.pay_type == 2).sort((a, b) => b.number - a.number) // 过滤出账单类型为收入的项\n      setPieChart()\n    }\n\n    // 切换收支构成类型\n    const changeTotalType = (type) => {\n      state.totalType = type\n    }\n\n    // 切换饼图收支类型\n    const changePieType = (type) => {\n      state.pieType = type\n      // 重绘饼图\n      setPieChart()\n    }\n\n    // 绘制饼图方法\n    const setPieChart = () => {\n      if (window.echarts) {\n        proportionChart = echarts.init(document.getElementById('proportion'));\n        const _data = state.pieType == 'expense' ? state.expense_data : state.income_data\n        proportionChart.setOption({\n            tooltip: {\n              trigger: 'item',\n              formatter: '{a} <br/>{b} : {c} ({d}%)'\n            },\n            // 图例\n            legend: {\n                data: _data.map(item => item.type_name)\n            },\n            series: [\n              {\n                name: '支出',\n                type: 'pie',\n                radius: '55%',\n                data: _data.map(item => {\n                  return {\n                    value: item.number,\n                    name: item.type_name\n                  }\n                }),\n                emphasis: {\n                  itemStyle: {\n                    shadowBlur: 10,\n                    shadowOffsetX: 0,\n                    shadowColor: 'rgba(0, 0, 0, 0.5)'\n                  }\n                }\n              }\n            ]\n        })\n      }\n    }\n    \n    // 月份弹窗开关\n    const monthToggle = () => {\n      popMonthRef.value.toggle()\n    }\n\n    const selectMonth = (item) => {\n      state.currentMonth = item\n      getData()\n    }\n\n    return {\n      ...toRefs(state),\n      popMonthRef,\n      selectMonth,\n      monthToggle,\n      changeTotalType,\n      changePieType\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n  @import url('../config/custom.less');\n  .data {\n    min-height: 100%;\n    background-color: #f5f5f5;\n    .total {\n      background-color: #fff;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      padding: 24px 0;\n      margin-bottom: 10px;\n      .time {\n        position: relative;\n        width: 96px;\n        padding: 6px;\n        background-color: #f5f5f5;\n        color: @color-text-base;\n        border-radius: 4px;\n        font-size: 14px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 16px;\n        span:nth-of-type(1)::after {\n           content: '';\n          position: absolute;\n          top: 9px;\n          bottom: 8px;\n          right: 28px;\n          width: 1px;\n          background-color: rgba(0, 0, 0, .5);\n        }\n        .van-icon-notes-o {\n          font-size: 16px;\n          color: @color-text-caption;\n        }\n      }\n      .title {\n        color: @primary;\n        margin-bottom: 8px;\n        font-size: 12px;\n        font-weight: 500;\n      }\n      .expense {\n        font-size: 24px;\n        color: @primary;\n        font-weight: 600;\n        margin-bottom: 16px;\n      }\n      .income {\n        color: @color-text-caption;\n        font-weight: 500;\n      }\n    }\n    .structure {\n      padding: 0 16px;\n      background-color: #fff;\n      margin-bottom: 10px;\n      .head {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 12px 0;\n        .title {\n          font-size: 18px;\n          color: @color-text-base;\n        }\n        .tab {\n          span {\n            display: inline-block;\n            width: 40px;\n            height: 24px;\n            background-color: #f5f5f5;\n            text-align: center;\n            line-height: 24px;\n            margin-left: 10px;\n            border-radius: 4px;\n          }\n          .expense {\n            &.active {\n              background-color: rgba(57, 190, 119, 0.2);\n              color: @primary;\n            }\n          }\n          .income {\n            &.active {\n              background-color: rgba(236, 190, 37, 0.2);\n              color: @text-warning;\n            }\n          }\n        }\n      }\n      .content {\n        .item {\n          display: flex;\n          height: 50px;\n          align-items: center;\n          .left {\n            flex: 4;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            margin-right: 10px;\n            .type {\n              display: flex;\n              align-items: center;\n              span:nth-of-type(1) {\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                border-radius: 50%;\n                width: 30px;\n                height: 30px;\n                margin-right: 10px;\n                color: #fff;\n              }\n              .expense {\n                background-color: @primary;\n              }\n              .income {\n                background-color: @text-warning;\n              }\n            }\n          }\n          .right {\n            flex: 8;\n            display: flex;\n            align-items: center;\n            .percent {\n              width: 160px\n            }\n            .momey {\n              width: 100px;\n            }\n          }\n        }\n      }\n    }\n    .proportion {\n      background-color: #fff;\n      padding: 12px;\n      .head {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 12px 0;\n        .title {\n          font-size: 18px;\n          color: @color-text-base;\n        }\n        .tab {\n          span {\n            display: inline-block;\n            width: 40px;\n            height: 24px;\n            background-color: #f5f5f5;\n            text-align: center;\n            line-height: 24px;\n            margin-left: 10px;\n            border-radius: 4px;\n          }\n          .expense {\n            &.active {\n              background-color: rgba(57, 190, 119, 0.2);\n              color: @primary;\n            }\n          }\n          .income {\n            &.active {\n              background-color: rgba(236, 190, 37, 0.2);\n              color: @text-warning;\n            }\n          }\n        }\n      }\n      #proportion {\n        width: 100%;\n        height: 400px;\n      }\n    }\n  }\n</style>"],"sourceRoot":""}]}