{"remainingRequest":"/www/wwwroot/vue/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/www/wwwroot/vue/src/views/Login.vue?vue&type=style&index=0&id=26084dc2&lang=less&scoped=true","dependencies":[{"path":"/www/wwwroot/vue/src/views/Login.vue","mtime":1627217647227},{"path":"/www/wwwroot/vue/node_modules/css-loader/dist/cjs.js","mtime":1627220028068},{"path":"/www/wwwroot/vue/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1627220029206},{"path":"/www/wwwroot/vue/node_modules/postcss-loader/src/index.js","mtime":1627220028710},{"path":"/www/wwwroot/vue/node_modules/less-loader/dist/cjs.js","mtime":1627220045351},{"path":"/www/wwwroot/vue/node_modules/cache-loader/dist/cjs.js","mtime":1627220017878},{"path":"/www/wwwroot/vue/node_modules/vue-loader-v16/dist/index.js","mtime":1627220029206}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgQGltcG9ydCB1cmwoJy4uL2NvbmZpZy9jdXN0b20ubGVzcycpOwogIC5hdXRoIHsKICAgIGhlaWdodDogY2FsYyh+IigxMDAlIC0gNDZweCkiKTsKICAgIHBhZGRpbmc6IDMwcHggMjBweCAwIDIwcHg7CiAgICBiYWNrZ3JvdW5kOiBAcHJpbWFyeS1iZzsKICAgIC5sb2dvIHsKICAgICAgd2lkdGg6IDE1MHB4OwogICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgbWFyZ2luOiAwIGF1dG87CiAgICAgIG1hcmdpbi1ib3R0b206IDMwcHg7CiAgICB9CiAgICAuZm9ybS13cmFwIHsKICAgICAgLmZvcm0gewogICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAudmFuLWNlbGw6Zmlyc3QtY2hpbGQgewogICAgICAgICAgcGFkZGluZy10b3A6IDIwcHg7CiAgICAgICAgfQogICAgICAgIC52YW4tY2VsbDpsYXN0LWNoaWxkIHsKICAgICAgICAgIHBhZGRpbmctYm90dG9tOiAyMHB4OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLmNoYW5nZS1idG4gewogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgIG1hcmdpbjogMTBweCAwOwogICAgICBjb2xvcjogQGxpbmstY29sb3I7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIH0KICB9Cg=="},{"version":3,"sources":["/www/wwwroot/vue/src/views/Login.vue"],"names":[],"mappings":";EAgJE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACpC,CAAC,CAAC,CAAC,CAAC,EAAE;IACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;IACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACvB,CAAC,CAAC,CAAC,CAAC,EAAE;MACJ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACrB;IACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACT,CAAC,CAAC,CAAC,CAAC,EAAE;QACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;UACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACnB;QACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;UACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtB;MACF;IACF;IACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACjB;EACF","file":"/www/wwwroot/vue/src/views/Login.vue","sourceRoot":"","sourcesContent":["<template>\n  <Header :title=\"type == 'login' ? '登录' : '注册'\" />\n  <div class=\"auth\">\n    <img class=\"logo\" src=\"//s.yezgea02.com/1606836859539/onpeice.png\" alt=\"\">\n    <van-form class=\"form-wrap\" @submit=\"onSubmit\" v-if=\"type == 'login'\">\n      <div class=\"form\">\n        <van-field\n          clearable\n          v-model=\"username\"\n          name=\"username\"\n          label=\"账号\"\n          placeholder=\"请输入账号\"\n          :rules=\"[{ required: true, message: '请填写账户' }]\"\n        />\n        <van-field\n          clearable\n          v-model=\"password\"\n          type=\"password\"\n          name=\"password\"\n          label=\"密码\"\n          placeholder=\"请输入密码\"\n          :rules=\"[{ required: true, message: '请填写密码' }]\"\n        />\n      </div>\n      <div style=\"margin: 16px 0;\">\n        <van-button round block type=\"primary\" native-type=\"submit\">\n          登录\n        </van-button>\n        <p @click=\"chanegType('register')\" class=\"change-btn\">没有账号，前往注册</p>\n      </div>\n    </van-form>\n    <van-form class=\"form-wrap\" @submit=\"onSubmit\" v-if=\"type == 'register'\">\n      <div class=\"form\">\n        <van-field\n          clearable\n          v-model=\"username\"\n          name=\"username\"\n          label=\"账号\"\n          placeholder=\"请输入账号\"\n          :rules=\"[{ required: true, message: '请填写账号' }]\"\n        />\n        <van-field\n          clearable\n          v-model=\"password\"\n          type=\"password\"\n          name=\"password\"\n          label=\"密码\"\n          placeholder=\"请输入密码\"\n          :rules=\"[{ required: true, message: '请填写密码' }]\"\n        />\n        <van-field\n          center\n          clearable\n          label=\"验证码\"\n          placeholder=\"输入验证码\"\n          v-model=\"verify\"\n        >\n          <template #button>\n            <VueImgVerify ref=\"verifyRef\" />\n          </template>\n        </van-field>\n      </div>\n      <div style=\"margin: 16px 0;\">\n        <van-button round block :loading=\"loading\" type=\"primary\" native-type=\"submit\">\n          注册\n        </van-button>\n        <p @click=\"chanegType('login')\" class=\"change-btn\">登录已有账号</p>\n      </div>\n    </van-form>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, ref, onMounted } from 'vue'\nimport VueImgVerify from '../components/VueImageVerify.vue'\nimport Header from '../components/Header.vue'\nimport axios from '../utils/axios'\nimport { Toast } from 'vant'\nimport router from '../router'\nexport default {\n  name: 'Login',\n  components: {\n    VueImgVerify,\n    Header\n  },\n  setup() {\n    const verifyRef = ref(null)\n    const state = reactive({\n      username: '',\n      password: '',\n      type: 'login', // 登录注册模式切换参数\n      verify: '', // 验证码输入框输入的内容\n      imgCode: '', // 生成的验证图片内的文字\n      loading: false\n    })\n\n    // 提交登录 or 注册表单\n    const onSubmit = async (values) => {\n      try {\n        if (state.type == 'login') {\n          const { data } = await axios.post('/user/login', {\n            username: state.username,\n            password: state.password\n          })\n          localStorage.setItem('token', data.token)\n          window.location.href = '/'\n        } else {\n          state.imgCode = verifyRef.value.imgCode || ''\n          if (verifyRef.value.imgCode.toLowerCase() != state.verify.toLowerCase()) {\n            console.log('verifyRef.value.imgCode', verifyRef.value.imgCode)\n            Toast.fail('验证码错误')\n            return\n          }\n          state.loading = true\n          const { data } = await axios.post('/user/register', {\n            username: state.username,\n            password: state.password\n          })\n          Toast.success('注册成功')\n          state.type = 'login'\n          state.loading = false\n        }\n      } catch (error) {\n        console.log(111)\n        state.loading = false\n      }\n    }\n\n    // 切换登录和注册两种模式\n    const chanegType = (type) => {\n      state.type = type\n    }\n\n    return {\n      ...toRefs(state),\n      onSubmit,\n      chanegType,\n      verifyRef\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n  @import url('../config/custom.less');\n  .auth {\n    height: calc(~\"(100% - 46px)\");\n    padding: 30px 20px 0 20px;\n    background: @primary-bg;\n    .logo {\n      width: 150px;\n      display: block;\n      margin: 0 auto;\n      margin-bottom: 30px;\n    }\n    .form-wrap {\n      .form {\n        border-radius: 10px;\n        overflow: hidden;\n        .van-cell:first-child {\n          padding-top: 20px;\n        }\n        .van-cell:last-child {\n          padding-bottom: 20px;\n        }\n      }\n    }\n    .change-btn {\n      text-align: center;\n      margin: 10px 0;\n      color: @link-color;\n      font-size: 14px;\n    }\n  }\n</style>"]}]}